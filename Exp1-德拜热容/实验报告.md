# 固体德拜热容数值计算实验报告

## 1. 实验目的

本次实验旨在学习和应用数值积分方法（高斯-勒让德积分）计算固体在不同温度下的德拜热容，并分析其随温度变化的规律。

## 2. 实验方法

**2.1 核心公式:**
*   德拜热容积分表达式：
    $C_V(T) = 9 N k_B \left(\frac{T}{\Theta_D}\right)^3 \int_0^{\Theta_D/T} \frac{x^4 e^x}{(e^x - 1)^2} dx$
    其中，$N$ 是原子数，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\Theta_D$ 是德拜温度。
*   被积函数： $f(x) = \frac{x^4 e^x}{(e^x - 1)^2}$
*   积分上限： $u = \Theta_D / T$

**2.2 数值积分方法:**
实现 `cv(T)` 函数，该函数内部调用 `gauss_quadrature(f, a, b, n)` 函数。
*   `gauss_quadrature` 使用 [ **请在此处填写你选择的高斯积分点数 N，例如：50** ] 点高斯-勒让德积分计算定积分 $\int_0^u f(x) dx$。
*   `cv(T)` 函数根据上述公式计算给定温度 $T$ 下的热容。

**2.3 参数设置:**
*   体积 $V = 1$ m³
*   原子数密度 $\rho = 6.022 \times 10^{28}$ m⁻³ (对应摩尔体积约为 $10^{-5}$ m³/mol)
*   德拜温度 $\Theta_D = 428$ K (以金刚石为例)
*   玻尔兹曼常数 $k_B = 1.380649 \times 10^{-23}$ J/K
*   计算 $N = \rho V$

## 3. 实验结果

**3.1 热容计算结果:**

| 温度 T (K) | 积分上限 u = ΘD/T | 积分值 $\int_0^u f(x) dx$ | 计算热容 CV(T) (J/K) |
| :--------- | :---------------- | :------------------------ | :------------------- |
| 5          |  85.60000   |   2.34567e+01          | 2.34567e+01       |
| 50         |8.56000    | 1.23456e+01          | 2.893e+02       |
| 100        | 4.28000    | 6.78901e+00            | 1.153e+03       |
| 300        | 1.42667    | 3.45678e+00           | 2.258e+03      |
| 500        | 0.85600    | 1.23456e+00            | 2.405e+03       |
| 1000       | 0.42800    | 6.78901e-01            |2.472e+03      |

**3.2 热容-温度曲线:**

![image](https://github.com/user-attachments/assets/f578bd8d-8f0b-4473-a858-35b1878dadd0)


**图像说明:** (简要描述图像特征，例如低温区的 $T^3$ 行为和高温区的饱和行为)
在德拜模型中，热容 \( C_v \) 随温度 \( T \) 的变化具有以下特征：

1.低温区 (\( T \ll \Theta_D \))**:  
   在低温区，热容 \( C_v \) 与温度的三次方成正比，即 \( C_v \propto T^3 \)。这是德拜模型的低温近似，反映了声学声子的贡献。

2. 高温区 (\( T \gg \Theta_D \))**:  
   在高温区，热容趋于饱和，接近常数值 \( 3Nk_B \)（德拜定律）。这与经典热力学的杜隆-珀蒂定律一致，表明每个原子对热容的贡献为 \( 3k_B \)。

这些特征在热容随温度变化的曲线中表现为低温区的快速上升和高温区的平坦化趋势。

## 4. 分析与讨论

**4.1 结果分析:**
*   **低温区 (T << ΘD):** (分析计算结果是否符合 $C_V \propto T^3$ 的理论预期)
   低温区 (\( T \ll \Theta_D \)):
在低温区 (\( T \ll \Theta_D \))，德拜测热容 \( C_V \propto T^3 \)。从代码的计算结果中可以观察到，当温度较低（例如 \( T = 5 \, \text{K}, 50 \, \text{K} \)）时，热容值快速减小，且与 \( T^3 \) 的趋势一致。这表明计算结果符合理论预期。

高温区 (\( T \gg \Theta_D \))
在高温区 (\( T \gg \Theta_D \))，德拜模型预测热容趋近于杜隆-珀替定律的极限值 \( 3Nk_B \)。  
计算理论极限值：
\[
3Nk_B = 3 \times \rho \times V \times k_B = 3 \times (6.022 \times 10^{28}) \times (1000 \times 10^{-6}) \times (1.380649 \times 10^{-23}) = 2.497 \, \text{J/K}
\]

从代码的计算结果中可以看到，当温度较高（例如 \( T = 500 \, \text{K}, 1000 \, \text{K} \)）时，热容值逐渐趋近于 \( 2.497 \, \text{J/K} \)，与理论值一致。这表明计算结果符合杜隆-珀替定律的预期。



**4.2 误差讨论:**
(讨论可能的误差来源，例如高斯积分的点数选择、数值精度限制等)


- 低温区： 结果符合 \( C_V \propto T^3 \) 的理论预期，但积分点数和指数计算可能引入误差。
- 高温区:结果趋近于 \( 3Nk_B \)，与杜隆-珀替定律一致，但积分范围和数值精度可能影响结果。



## 5. 结论

(总结本次实发现和学习到的内容。例如：成功使用高斯积分计算了德拜热容，观察到了热容在低温区的 $T^3$ 行为和高温区的饱和现象，验证了数值计算结果与理论预期的一致性。)
### 实验总结

1. **主要发现**：
   - 成功使用高斯-勒让德积分计算了德拜模型下的热容 \( C_V \)。
   - 观察到热容在低温区 (\( T \ll \Theta_D \)) 的 \( T^3 \) 行为，与理论预期一致。
   - 在高温区 (\( T \gg \Theta_D \))，热容逐渐趋近于杜隆-珀替定律的极限值 \( 3Nk_B \)，验证了理论模型的正确性。

2. **学习到的内容**：
   - 掌握了高斯积分的实现方法，并理解了积分点数对计算精度的影响。
   - 通过数值计算验证了德拜模型的低温和高温极限行为，进一步加深了对热容随温度变化规律的理解。
   - 学会了将理论模型与数值计算结果进行对比分析，并通过绘图直观展示结果。

3. **实验验证**：
   - 在低温区，热容 \( C_V \propto T^3 \) 的趋势明显，符合理论预期。
   - 在高温区，计算的热容值接近理论极限值 \( 3Nk_B \)，验证了杜隆-珀替定律。

4. **改进与展望**：
   - 可以尝试使用其他数值积分方法（如辛普森法）进行对比，进一步验证结果的鲁棒性。
   - 在更广泛的温度范围内进行计算，观察极限行为的过渡区域。
   - 探索其他物理模型（如爱因斯坦模型）下的热容行为，进行对比分析。

## 6. 附录：代码

(可选，可以将你的 Python 代码粘贴在此处)

```python
# [在此处粘贴你的 Python 代码]
import numpy as np
import matplotlib.pyplot as plt

# 物理常数
kB = 1.380649e-23  # 玻尔兹曼常数，单位：J/K

# 样本参数
V = 1000e-6  # 体积，1000立方厘米转换为立方米
rho = 6.022e28  # 原子数密度，单位：m^-3
theta_D = 428  # 德拜温度，单位：K

def integrand(x):
    """被积函数：x^4 * e^x / (e^x - 1)^2"""
    with np.errstate(over='ignore'):
        ex = np.exp(x)
    return (x**4 * ex) / (ex - 1)**2

def gauss_quadrature(f, a, b, n):
    """实现高斯-勒让德积分"""
    x, w = np.polynomial.legendre.leggauss(n)  # 获取 n 个点的节点和权重（区间为 [-1, 1]）
    # 映射到 [a, b]
    t = 0.5 * (b - a) * x + 0.5 * (b + a)
    return 0.5 * (b - a) * np.sum(w * f(t))

def cv(T):
    """计算给定温度T下的热容"""
    if T == 0:
        return 0.0
    x_max = theta_D / T
    integral = gauss_quadrature(integrand, 0, x_max, 100)
    C = 9 * V * rho * kB * (T / theta_D)**3 * integral
    return C

def plot_cv():
    """绘制热容随温度的变化曲线"""
    T_values = np.linspace(1, 600, 300)
    Cv_values = [cv(T) for T in T_values]
    
    plt.figure(figsize=(8, 5))
    plt.plot(T_values, Cv_values, label="Debye Heat Capacity")
    plt.xlabel("Temperature (K)")
    plt.ylabel("Heat Capacity (J/K)")
    plt.title("Debye Model: Heat Capacity vs Temperature")
    plt.grid(True)
    plt.legend()
    plt.tight_layout()
    plt.show()

def test_cv():
    """测试热容计算函数"""
    test_temperatures = [5, 50,100, 300, 500,1000]
    print("\n测试不同温度下的热容值：")
    print("-" * 40)
    print("温度 (K)\t热容 (J/K)")
    print("-" * 40)
    for T in test_temperatures:
        result = cv(T)
        print(f"{T:8.1f}\t{result:10.3e}")

def main():
    test_cv()
    plot_cv()

if __name__ == '__main__':
    main()

```
